---
title: "econometria"
author: "Geoconda Molina"
date: "2023-12-29"
output: html_document
---

```{r setup, include=FALSE}
#leamos la base de datos

library(readxl)
library(dplyr)

data <- read.csv("Video Games Sales.csv",sep = ",")

View(data)
# nrow(data) #numero de datos 

#filtremos los datos NA y eligamos 4 tipos de consolas y generos
tipos_consola <- c("PS3", "PS2", "X360","Wii")

tipos_genero <- c("Shooter", "Sports", "Action","Misc")

#construyamos la data

data_new <- data |>
  filter(Platform %in% tipos_consola & Genre %in% tipos_genero)
 

#View(data_new)

######___________________

# construyamos el modelo

modelo <- lm(Global ~ Rank+Platform+Genre+Review, data = data_new)


# R pone la categoria base, genero=Action, plataforma= PS2
summary(modelo)
# del summary obtenemos que ya que el valor Pr(>|t|) es menor a 0.05
# concluimos que las siguientes variables son significativas 

# intersepto (PS2, ACTION)??
# Rank
# PlatformWii
# 

#_____________________________________

# intervalos de confianza para los betas TODOS

intervalos_confianza <- confint(modelo)
print(intervalos_confianza)


#______________________________________________
#diferencias significativas entre los betas (Prueba F)


#_______________________________________________-
# prueba ML (prueba conjunta) 

# DE DOS VARIABLES 


# Consideramos el modelo inicial abriendo las categorias del genero del juego:
# categoria base: Action
# global = b_0+b_1*GenreMISC+b_2*GenreSHOOTER+b_3*GenreSPORTS+b_4*Review+B_5*Platform+b_6*Rank

# construyamos el modelo, creando los grupos de la variable categorica GÃ©nero del juego
data_categ_1 <- data_new |>
  mutate(Misc = ifelse(Genre == "Misc",1,0),
         Shooter = ifelse(Genre == "Shooter",1,0),
         Sports = ifelse(Genre == "Sports",1,0))

View(data_categ_1)



#  Probemos: si es conjuntamente significativo b_1 y b_2


# modelo restringido 
modelo_res <- lm(Global ~ Rank+Platform+Review+Sports, data = data_categ_1)

summary(modelo_res)
#obtengamos los residuos
residuos_res <- modelo_res$residuals

# hagamos el modelo auxiliar

modelo_aux <-lm(residuos_res ~ Rank+Platform+Review+Sports+Misc+Shooter, data = data_categ_1)

# Obtengamos el valor ML del modelo auxiliar

ML <- summary(modelo_aux)$r.square*601
ML

# chi

chi_2 <- qchisq(0.95,2)

# valor p, es la proba desde el ML para abajo

v_p <- pchisq(ML, 2, lower.tail = FALSE) #false por la colita de la derecha

v_p

# vemos que v_p> 0.05 por lo que se rechaza la prueba
# es decir la categoria MISC Y SHOOTER son significativos conjuntamente 

#______________________________

#  Probemos: si es conjuntamente significativo b_3 y b_4


# modelo restringido 
modelo_res_1 <- lm(Global ~ Rank+Platform+Misc+Shooter, data = data_categ_1)

summary(modelo_res_1)
#obtengamos los residuos
residuos_res_1 <- modelo_res_1$residuals

# hagamos el modelo auxiliar

modelo_aux_1 <-lm(residuos_res_1 ~ Rank+Platform+Review+Sports+Misc+Shooter, data = data_categ_1)

# Obtengamos el valor ML del modelo auxiliar

ML <- summary(modelo_aux_1)$r.square*601
ML

# chi

chi_2 <- qchisq(0.95,2)

# valor p, es la proba desde el ML para abajo

v_p <- pchisq(ML, 2, lower.tail = FALSE) #false por la colita de la derecha

v_p

# vemos que v_p> 0.05 por lo que se rechaza la prueba
# es decir la categoria Sports y la variable Review son significativos conjuntamente 

#______________________________

#  Probemos: si es conjuntamente significativo b_3 y b_4


# modelo restringido 
modelo_res_1 <- lm(Global ~ Rank+Platform+Misc+Shooter, data = data_categ_1)

summary(modelo_res_1)
#obtengamos los residuos
residuos_res_1 <- modelo_res_1$residuals

# hagamos el modelo auxiliar

modelo_aux_1 <-lm(residuos_res_1 ~ Rank+Platform+Review+Sports+Misc+Shooter, data = data_categ_1)

# Obtengamos el valor ML del modelo auxiliar

ML <- summary(modelo_aux_1)$r.square*601
ML

# chi

chi_2 <- qchisq(0.95,2)

# valor p, es la proba desde el ML para abajo

v_p <- pchisq(ML, 2, lower.tail = FALSE) #false por la colita de la derecha

v_p

# vemos que v_p> 0.05 por lo que se rechaza la prueba
# es decir la categoria Sports y la variable Review son significativos conjuntamente 





```

